<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
  <title>간단한 지도 표시하기</title>
  <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=x84uw6z21k"></script>
</head>

<body>
  <div id="map" style="width:100%;height:400px;"></div>

  <script>

    fetch('assets/25q3_ev.csv')
      .then(res => res.text())
      .then(csv => {
        const lines = csv.split('\n').map(x => x.trim()).filter(x => x);
        // 지도 중심: 첫 라인의 센터
        let centerLat = 38.44893594, centerLng = 128.4598665;
        // 라인별 마커 좌표 추출
        const markers = [];
        lines.forEach(line => {
          const cells = line.split(',');
          if (cells.length < 8) return; // 유효한 라인이 아니면 건너뜀
          let type = cells[0];
          if (type === '환경부') {
            // 앞쪽의 위경도값
            let lng = parseFloat(cells[1]);
            let lat = parseFloat(cells[2]);
            markers.push({ lat, lng, title: cells[3] });
            centerLat = lat; centerLng = lng;
          } else if (type === 'HERE') {
            // 뒤쪽의 위경도값
            let lat = parseFloat(cells[5]);
            let lng = parseFloat(cells[4]);
            markers.push({ lat, lng, title: cells[3] });
            centerLat = lat; centerLng = lng;
          }
        });

        // 네이버 지도 초기화
        var map = new naver.maps.Map('map', {
          center: new naver.maps.LatLng(centerLat, centerLng),
          zoom: 15
        });
        // 마커 표시
        markers.forEach(mark => {
          new naver.maps.Marker({
            position: new naver.maps.LatLng(mark.lat, mark.lng),
            map: map,
            title: mark.title
          });
        });
      });

  </script>
</body>

</html>