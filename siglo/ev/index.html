<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
  <title>간단한 지도 표시하기</title>
  <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=x84uw6z21k"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>

<body>
  <div id="map" style="width:100%;height:100%;"></div>
  <div id="progress"></div>

  <script>

    var map = new naver.maps.Map('map', {
      center: new naver.maps.LatLng(38.44893594, 128.4598665),
      zoom: 13
    });

    let totalCount = 0;
    let processedCount = 0;

    Papa.parse('assets/25q3_ev.csv', {
      download: true,
      header: false,
      worker: true,
      step: function (row) {
        const cells = row.data;
        if (!cells || cells.length < 8) return;
        let type = cells[0];
        let name = cells[1];
        let lat, lng;

        if (type === "환경부") {
          lng = parseFloat(cells[2]);
          lat = parseFloat(cells[3]);
        } else if (type === "HERE") {
          lat = parseFloat(cells[4]);
          lng = parseFloat(cells[5]);
        } else {
          return;
        }

        // 실제 지도에 마커 표시
        new naver.maps.Marker({
          position: new naver.maps.LatLng(lat, lng),
          map: map,
          title: name
        });

        // 진행률 표시
        processedCount++;
        if (processedCount % 500 === 0) {
          document.getElementById("progress").textContent = `처리 중: ${processedCount}개 마커`;
        }
      },
      complete: function (results) {
        document.getElementById("progress").textContent = `마커 처리 완료: ${processedCount}개`;
      }
    });
  </script>
</body>

</html>